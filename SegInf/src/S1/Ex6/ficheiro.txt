Usando a biblioteca JCA, realize em Java uma aplicação para cifrar ficheiros com um esquema híbrido, ou seja, usando cifra simétrica e assimétrica. O conteúdo do ficheiro é cifrado com uma chave simétrica, a qual é cifrada com a chave pública do destinatário do ficheiro. A aplicação recebe na linha de comandos a opção para cifrar (-enc) ou decifrar (-dec) e o ficheiro para cifrar/decifrar.
No modo para cifrar, a aplicação também recebe o certificado com a chave pública do destinatário e produz dois ficheiros, um com o conteúdo original cifrado e outro com a chave simétrica cifrada. Ambos os ficheiros devem ser codificados em Base64. Valorizam-se soluções que validem o certificado antes de ser usada a chave pública e que não imponham limites à dimensão do ficheiro a cifrar/decifrar.
No modo para decifrar, a aplicação recebe também i) ficheiro com conteúdo original cifrado; ii) ficheiro com chave simétrica cifrada; iii) keystore com a chave privada do destinatário; e produz um novo ficheiro com o conteúdo original decifrado.
Para a codificação e descodificação em stream de bytes em Base64 deve usar a biblioteca Apache Commons Codec [1].
Considere os ficheiros .cer e .pfx em anexo ao enunciado onde estão chaves públicas e privadas necessárias para testar a aplicação.
